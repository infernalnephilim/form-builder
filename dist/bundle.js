!function(e){var n={};function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(o,i,function(n){return e[n]}.bind(null,i));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n){var t;const o="questionList-indexeddb",i=1,s="questions";var r=[],u=1,a=document.getElementById("form-builder"),l=document.getElementById("add-input");function d(e,n){return t.transaction(e,n).objectStore(e)}function c(e){var n;void 0===e&&(e=d(s,"readwrite")),(n=e.getAll()).onsuccess=function(e){(function e(n,t){t+=1;for(let o=0,i=n.length;o<i;o++)n[o].id>u&&(u=n[o].id+1),a.insertBefore(f(n[o],t),l),n[o].subquestions.length>0&&e(n[o].subquestions,t)})(r=n.result,0)},n.onerror=function(e){console.error("add error",this.error),console.log(this.error)}}function p(e,n,t,o,i){return u++,{id:e,condition:n,conditionAnswer:t,question:o,type:i,subquestions:[]}}function f(e,n){var t=document.createElement("div");t.setAttribute("id",e.id),t.classList.add("question-wrapper-div"),t.style.marginLeft=20*(n-1)+"px";var o='<ul class="question-wrapper">';""!=e.condition&&(o+='<li class="form-row">\n          <label class="item">Condition</label>\n          <select class="condition-type item flex-1">\n            <option>\n              Equals\n            </option>\n',"Number"==e.type&&(o+="            <option>\n              Greater than\n            </option>\n            <option>\n              Less Than\n            </option>\n"),o+="          </select>\n","Text"==e.type||"Number"==e.type?o+='<input class="condition-text flex-1" type="text" value=\''+e.conditionAnswer+"'/>\n":o+='          <select class="condition-yesno item flex-1">\n            <option selected>\n              Yes\n            </option>\n            <option>\n              No\n            </option>\n          </select>\n',o+="        </li>"),o+='<li class="form-row">\n          <label class="item">Question</label>\n          <input class="question-input text item" name="question[]" value=\''+e.question+'\'/>\n        </li>\n        <li class="form-row">\n          <label class="item">Type</label>\n          <select class="select-type item">\n',"Yes/No"==e.type?o+="<option selected>\n              Yes/No\n            </option>\n            <option>\n              Text\n            </option>\n            <option>\n              Number\n            </option>\n":"Text"==e.type?o+="<option>\n              Yes/No\n            </option>\n            <option selected>\n              Text\n            </option>\n            <option>\n              Number\n            </option>\n":"Number"==e.type&&(o+="<option>\n              Yes/No\n            </option>\n            <option>\n              Text\n            </option>\n            <option selected>\n              Number\n            </option>\n"),o+='</select>\n        </li>\n        <li class="form-row">\n          <button class="add-sub-input">Add Sub-Input</button>\n          <button class="delete-input">Delete</button>\n        </li>        </ul>',t.innerHTML=o,t.getElementsByClassName("add-sub-input")[0].addEventListener("click",o=>{let i=t.getElementsByClassName("add-sub-input")[0].parentNode.parentNode.parentNode;o.preventDefault();let s="";"Yes/No"==e.type&&(s="Yes");var r=p(u,"Equals",s,"",e.type);e.subquestions.push(r),console.log(e.id),a.insertBefore(f(r,n+1),i.nextSibling),g("Your changes might not be saved","notsaved")}),t.getElementsByClassName("delete-input")[0].addEventListener("click",t=>{t.preventDefault(),function e(n){if(n.subquestions.length>0){for(let t=0;t<n.subquestions.length;t++)e(n.subquestions[t]);n.subquestions=[]}document.getElementById(n.id).remove()}(e),r=function e(n,t,o){return n.filter(function(n){return n.subquestions.length>0&&(n.subquestions=e(n.subquestions,t,o)),n.id!==t})}(r,e.id,n),g("Your changes might not be saved","notsaved")});var i=t.getElementsByTagName("input");if(i.length>0)for(let e=0;e<i.length;e++)i[e].addEventListener("change",()=>{let n=i[e].parentNode.parentNode.parentNode.id;b(r,i[e],n),g("Your changes might not be saved","notsaved")},!1);var s=t.getElementsByTagName("select");if(s.length>0)for(let e=0;e<s.length;e++)s[e].addEventListener("change",()=>{let n=s[e].parentNode.parentNode.parentNode.id;b(r,s[e],n),g("Your changes might not be saved","notsaved")});return t}function g(e,n){let t=document.getElementById("save-message");t.innerHTML=e,"saved"==n?t.classList.remove("urgent"):t.classList.add("urgent")}function b(e,n,t){for(let o=0,i=e.length;o<i;o++){if(e[o].id==t)return void(n.classList.contains("condition-type")?e[o].condition=n.value:n.classList.contains("condition-text")?e[o].conditionAnswer=n.value:n.classList.contains("condition-yesno")?e[o].conditionAnswer=n.value:n.classList.contains("question-input")?e[o].question=n.value:n.classList.contains("select-type")&&(e[o].type=n.value));e[o].subquestions.length>0&&b(e[o].subquestions,n,t)}}!function(){return"indexedDB"in window&&!/iPad|iPhone|iPod/.test(navigator.platform)}?window.alert("Your browser doesn't support a stable version of IndexedDB."):function(){var e=indexedDB.open(o,i);e.onsuccess=function(e){c((t=this.result).store),document.getElementById("save-data").addEventListener("click",e=>{e.preventDefault(),function(e){if(console.log("saveAllChanges"),void 0===e&&(e=d(s,"readwrite")),e.clear(),r.length>0)for(let n=0;n<r.length;n++)e.put(r[n]);let n=new Date;g("Last saved: "+n.getDate()+"."+n.getMonth()+"."+n.getFullYear()+" "+n.getHours()+":"+n.getMinutes(),"saved")}(t.store)})},e.onerror=function(e){console.error("openDb:",e.target.errorCode)},e.onupgradeneeded=function(e){console.log("openDb.onupgradeneeded");var n=e.currentTarget.result.createObjectStore(s,{keyPath:"id",autoIncrement:!0});n.createIndex("id","id",{unique:!0}),n.createIndex("conditionAnswer","conditionAnswer",{unique:!1}),n.createIndex("condition","condition",{unique:!1}),n.createIndex("question","question",{unique:!1}),n.createIndex("type","type",{unique:!1}),n.createIndex("subquestions","subquestions",{unique:!1})}}(),l.addEventListener("click",e=>{e.preventDefault();let n=p(u,"","","","Yes/No");a.insertBefore(f(n,1),l),r.push(n),g("Your changes might not be saved","notsaved"),u++})}]);